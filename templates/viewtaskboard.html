<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Board</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .task-card {
            transition: all 0.2s ease;
        }

        .task-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .kanban-column {
            min-height: 70vh;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen">
    <div id="loading-overlay" class="fixed inset-0 bg-white bg-opacity-80 z-50 flex items-center justify-center">
        <div class="flex flex-col items-center">
            <div class="w-16 h-16 border-t-4 border-purple-600 border-solid rounded-full animate-spin mb-4"></div>
            <p class="text-purple-800 text-lg font-medium">Loading your workspace...</p>
        </div>
    </div>

    <div id="error-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center">
        <div class="bg-white rounded-lg p-8 max-w-md w-full">
            <div class="flex items-center mb-6">
                <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center mr-4">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-red-600" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                </div>
                <h3 class="text-xl font-bold text-gray-900">Something went wrong</h3>
            </div>
            <p id="error-message" class="text-gray-700 mb-6">Unable to load task board data.</p>
            <button id="error-close-btn"
                class="w-full py-3 bg-red-600 hover:bg-red-700 text-white font-medium rounded-lg transition-colors">
                Try Again
            </button>
        </div>
    </div>

    <div class="flex h-screen overflow-hidden" id="app-container">
        <div class="hidden md:flex md:flex-shrink-0">
            <div class="flex flex-col w-64 bg-purple-900 text-white">
                <div class="flex items-center justify-center h-16 border-b border-purple-800">
                    <h1 class="text-xl font-bold">TaskBoard</h1>
                </div>
                <div class="flex flex-col flex-grow px-5 py-6">
                    <div class="flex flex-col space-y-2">
                        <a href="#" class="flex items-center px-4 py-3 hover:bg-purple-800 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                            <span>Home</span>
                        </a>
                        <a href="#" class="flex items-center px-4 py-3 bg-purple-800 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                            <span>Task Board</span>
                        </a>


                    </div>

                    <div class="mt-10">
                        <h2 class="text-xs font-semibold text-purple-300 uppercase tracking-wider mb-3">
                            Team
                        </h2>
                        <div id="sidebar-team-members" class="space-y-2">
                        </div>
                        <button id="sidebar-show-team"
                            class="mt-3 flex items-center text-sm text-purple-300 hover:text-white">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                            Manage Team
                        </button>
                    </div>

                    <div class="mt-auto">
                        <button id="logout-btn"
                            class="w-full flex items-center px-4 py-3 text-purple-200 hover:bg-purple-800 rounded-lg">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                            </svg>
                            <span>Logout</span>
                        </button>
                        <div class="flex items-center px-4 py-3 mt-2 bg-purple-800 rounded-lg">
                            <div id="user-avatar"
                                class="flex-shrink-0 h-8 w-8 rounded-full bg-purple-600 flex items-center justify-center text-white font-medium">
                                U
                            </div>
                            <div class="ml-3">
                                <p id="user-name" class="text-sm font-medium">User</p>
                                <p id="user-email" class="text-xs text-purple-300">user@example.com</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="flex-1 flex flex-col overflow-hidden">
            <header class="bg-white shadow-sm z-10">
                <div class="flex items-center justify-between h-16 px-6">
                    <div class="flex items-center">
                        <button id="mobile-menu-button" class="md:hidden mr-4 text-gray-500 hover:text-gray-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                        </button>
                        <div class="flex items-center">
                            <h2 id="board-name" class="text-xl font-semibold text-gray-800">My Task Board</h2>
                            <button id="edit-board-name" class="ml-2 text-gray-400 hover:text-gray-600">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
                                </svg>
                            </button>
                            <button class="text-red-500 hover:text-red-700 delete-task-board" id="delete-task-board">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <button id="show-team-modal"
                            class="flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z" />
                            </svg>
                            Team
                        </button>
                        <button id="add-task-btn"
                            class="flex items-center px-3 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" fill="none" viewBox="0 0 24 24"
                                stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                            </svg>
                            Add Task
                        </button>
                    </div>
                </div>
            </header>

            <div class="bg-white border-b px-6 py-4">
                <div class="grid grid-cols-3 gap-4">
                    <div class="bg-purple-50 rounded-lg p-4 flex items-center">
                        <div class="rounded-full bg-purple-100 p-3 mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-purple-600" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-purple-600 font-medium">Total Tasks</p>
                            <p id="total-count" class="text-2xl font-bold text-purple-900">0</p>
                        </div>
                    </div>
                    <div class="bg-green-50 rounded-lg p-4 flex items-center">
                        <div class="rounded-full bg-green-100 p-3 mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-green-600" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-green-600 font-medium">Completed</p>
                            <p id="completed-count" class="text-2xl font-bold text-green-900">0</p>
                        </div>
                    </div>
                    <div class="bg-amber-50 rounded-lg p-4 flex items-center">
                        <div class="rounded-full bg-amber-100 p-3 mr-4">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-amber-600" fill="none"
                                viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                        </div>
                        <div>
                            <p class="text-sm text-amber-600 font-medium">Active tasks</p>
                            <p id="active-count" class="text-2xl font-bold text-amber-900">0</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="flex-1 overflow-auto p-6 bg-gray-50">
                <div class="flex h-full space-x-6">
                    <div class="flex-1 flex flex-col bg-gray-100 rounded-lg shadow">
                        <div class="p-4 border-b border-gray-200 bg-white rounded-t-lg">
                            <h3 class="font-medium text-gray-700 flex items-center">
                                <span class="w-3 h-3 rounded-full bg-amber-400 mr-2"></span>
                                To Do
                            </h3>
                        </div>
                        <div id="todo-column" class="flex-1 p-4 overflow-auto kanban-column">
                        </div>
                    </div>

                    <div class="flex-1 flex flex-col bg-gray-100 rounded-lg shadow">
                        <div class="p-4 border-b border-gray-200 bg-white rounded-t-lg">
                            <h3 class="font-medium text-gray-700 flex items-center">
                                <span class="w-3 h-3 rounded-full bg-blue-400 mr-2"></span>
                                In Progress
                            </h3>
                        </div>
                        <div id="inprogress-column" class="flex-1 p-4 overflow-auto kanban-column">
                        </div>
                    </div>

                    <div class="flex-1 flex flex-col bg-gray-100 rounded-lg shadow">
                        <div class="p-4 border-b border-gray-200 bg-white rounded-t-lg">
                            <h3 class="font-medium text-gray-700 flex items-center">
                                <span class="w-3 h-3 rounded-full bg-green-400 mr-2"></span>
                                Completed
                            </h3>
                        </div>
                        <div id="completed-column" class="flex-1 p-4 overflow-auto kanban-column">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="team-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center px-6 py-4 border-b">
                <h3 class="text-lg font-medium text-gray-900">Team Members</h3>
                <button id="close-team-modal" class="text-gray-400 hover:text-gray-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="flex-1 overflow-auto p-6">
                <div id="team-members-list" class="space-y-4">
                </div>
                <div class="mt-6 pt-6 border-t" id="add-team-member">
                    <h4 class="font-medium text-gray-700 mb-3">Add Team Member</h4>
                    <div class="flex">
                        <select id="new-team-member"
                            class="flex-1 rounded-l-md border-r-0 border-gray-300 focus:ring-purple-500 focus:border-purple-500">
                            <option value="">Select a user</option>
                        </select>
                        <button id="add-team-member-btn"
                            class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-r-md">
                            Add
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="edit-name-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl max-w-md w-full p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">Edit Board Name</h3>
            <input type="text" id="board-name-input"
                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent mb-4">
            <div class="flex justify-end space-x-3">
                <button id="cancel-edit-name"
                    class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                    Cancel
                </button>
                <button id="save-board-name" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-md">
                    Save
                </button>
            </div>
        </div>
    </div>

    <div id="task-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 z-40 flex items-center justify-center">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col">
            <div class="flex justify-between items-center px-6 py-4 border-b">
                <h3 id="task-modal-title" class="text-lg font-medium text-gray-900">Add New Task</h3>
                <button id="close-task-modal" class="text-gray-400 hover:text-gray-500">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="flex-1 overflow-auto p-6">
                <input type="hidden" id="edit-task-id">
                <div class="space-y-4">
                    <div>
                        <label for="task-title" class="block text-sm font-medium text-gray-700 mb-1">Title</label>
                        <input type="text" id="task-title"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="task-status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <select id="task-status"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="todo">To Do</option>
                            <option value="inprogress">In Progress</option>
                            <option value="completed">Completed</option>
                        </select>
                    </div>
                    <div>
                        <label for="task-due-date" class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
                        <input type="date" id="task-due-date"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    </div>
                    <div>
                        <label for="task-assignee" class="block text-sm font-medium text-gray-700 mb-1">Assign
                            to</label>
                        <select id="task-assignee"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                            <option value="">Unassigned</option>
                        </select>
                    </div>
                    <div id="completion-date-container" class="hidden">
                        <label for="task-completion-date" class="block text-sm font-medium text-gray-700 mb-1">
                            Completion Date & Time
                        </label>
                        <input type="datetime-local" id="task-completion-date"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    </div>

                </div>
            </div>
            <div class="px-6 py-4 border-t bg-gray-50 rounded-b-lg">
                <div class="flex justify-end space-x-3">
                    <button id="delete-task-btn"
                        class="hidden px-4 py-2 border border-red-300 text-red-700 rounded-md hover:bg-red-50">
                        Delete
                    </button>
                    <button id="cancel-task-btn"
                        class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                        Cancel
                    </button>
                    <button id="save-task-btn"
                        class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-md">
                        Save
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="mobile-menu" class="hidden fixed inset-0 z-40">
        <div class="fixed inset-0 bg-black opacity-25"></div>
        <div class="fixed inset-y-0 left-0 max-w-xs w-full bg-purple-900 text-white flex flex-col">
            <div class="flex items-center justify-between h-16 px-6 border-b border-purple-800">
                <h1 class="text-xl font-bold">TaskFlow</h1>
                <button id="close-mobile-menu" class="text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <div class="flex-1 px-4 py-6 overflow-auto">
                <div class="flex flex-col space-y-2">

                    <a href="/" class="flex items-center px-4 py-3 bg-purple-800 rounded-lg cursor-pointer">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg>
                        <span>Home</span>
                    </a>
                    <a href="/" class="flex items-center px-4 py-3 bg-purple-800 rounded-lg cursor-pointer">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-3" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg>
                        <span>Task Board</span>
                    </a>


                </div>

                <div class="mt-10">
                    <h2 class="text-xs font-semibold text-purple-300 uppercase tracking-wider mb-3">
                        Team
                    </h2>
                    <div id="mobile-team-members" class="space-y-2">
                    </div>
                    <button id="mobile-show-team"
                        class="mt-3 flex items-center text-sm text-purple-300 hover:text-white">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                        </svg>
                        Manage Team
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>

        const pathSegments = window.location.pathname.split('/');
        const boardId = pathSegments[pathSegments?.length - 1] || '1';
        console.log("board id ", boardId)
        let userEmailDecoded = ""
        let allUsers = [];
        let board = {
            name: "",
            admin: "",
            collaborators: [],
            tasks: []
        };

        const loadingOverlay = document.getElementById('loading-overlay');
        const errorModal = document.getElementById('error-modal');
        const errorMessage = document.getElementById('error-message');
        const errorCloseBtn = document.getElementById('error-close-btn');
        const appContainer = document.getElementById('app-container');


        const userAvatar = document.getElementById('user-avatar');
        const userName = document.getElementById('user-name');
        const userEmail = document.getElementById('user-email');


        const boardNameEl = document.getElementById('board-name');
        const editBoardNameBtn = document.getElementById('edit-board-name');
        const deleteTaskBoardBtn = document.getElementById('delete-task-board')
        const editNameModal = document.getElementById('edit-name-modal');
        const boardNameInput = document.getElementById('board-name-input');
        const saveBoardNameBtn = document.getElementById('save-board-name');
        const cancelEditNameBtn = document.getElementById('cancel-edit-name');

        const showTeamModalBtn = document.getElementById('show-team-modal');
        const sidebarShowTeamBtn = document.getElementById('sidebar-show-team');
        const teamModal = document.getElementById('team-modal');
        const closeTeamModalBtn = document.getElementById('close-team-modal');
        const teamMembersList = document.getElementById('team-members-list');
        const sidebarTeamMembers = document.getElementById('sidebar-team-members');
        const newTeamMemberSelect = document.getElementById('new-team-member');
        const addTeamMemberBtn = document.getElementById('add-team-member-btn');
        const addTeamMemberSection = document.getElementById('add-team-member');

        const addTaskBtn = document.getElementById('add-task-btn');
        const taskModal = document.getElementById('task-modal');
        const closeTaskModalBtn = document.getElementById('close-task-modal');
        const taskModalTitle = document.getElementById('task-modal-title');
        const editTaskIdInput = document.getElementById('edit-task-id');
        const taskTitleInput = document.getElementById('task-title');
        const taskStatusSelect = document.getElementById('task-status');
        const taskDueDateInput = document.getElementById('task-due-date');
        const taskAssigneeSelect = document.getElementById('task-assignee');
        const completionDateContainer = document.getElementById('completion-date-container');
        const taskCompletionDateInput = document.getElementById('task-completion-date');
        const deleteTaskBtn = document.getElementById('delete-task-btn');
        const cancelTaskBtn = document.getElementById('cancel-task-btn');
        const saveTaskBtn = document.getElementById('save-task-btn');
        const logoutBtn = document.getElementById('logout-btn')

        const todoColumn = document.getElementById('todo-column');
        const inprogressColumn = document.getElementById('inprogress-column');
        const completedColumn = document.getElementById('completed-column');

        const activeCountEl = document.getElementById('active-count');
        const completedCountEl = document.getElementById('completed-count');
        const totalCountEl = document.getElementById('total-count');

        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const closeMobileMenuBtn = document.getElementById('close-mobile-menu');
        const mobileTeamMembers = document.getElementById('mobile-team-members');
        const mobileShowTeamBtn = document.getElementById('mobile-show-team');

        logoutBtn.addEventListener('click', () => {
            document.cookie = "token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;";
            window.location.href = "/";
        });


        async function checkBoardName(boardName) {
            console.log("checking board name ", boardName)
            const boardNameResponse = await fetch("/verifyBoardNameExist", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: boardName })
            })
            const boardNameExist = await boardNameResponse.json()
            return boardNameExist?.boardNameExist
        }
        async function checkTaskTitle(boardName, boardId) {
            console.log("checking board name ", boardName)
            const taskNameResponse = await fetch("/verifyTaskNameExist", {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ name: boardName, boardId: boardId })
            })
            const taskNameExist = await taskNameResponse.json()
            return taskNameExist?.TaskNameExist
        }

        async function init() {
            try {
                showLoadingState();

                await Promise.all([fetchUsers(), fetchTaskBoard(), fetchLoginUser()]);

                await Promise.all([authenticateUser()])
                updateUI();

                hideLoadingState();
            } catch (error) {
                console.error("Error initializing app:", error);
                showErrorState("Error loading task board", error.message || "Please try again later");
            }
        }

        function fetchLoginUser() {
            const token = getAuthTokenFromCookies(document.cookie);
            if (token) {
                userEmailDecoded = decodeJWT(token).email || "User"
            }
            else {
                window.location.href = "/";

            }
        }

        function authenticateUser() {
            console.log("user email ", userEmailDecoded, board)
            if (!board.collaborators.includes(userEmailDecoded)) {
                window.location.href = "/taskboards";
            }
        }

        function getAuthTokenFromCookies(cookies) {
            const cookieArray = cookies.split(';');
            for (let i = 0; i < cookieArray.length; i++) {
                const cookie = cookieArray[i].trim();
                if (cookie.startsWith('token=')) {
                    return cookie.substring(6);
                }
            }
            return null;
        }

        function decodeJWT(token) {
            try {
                const base64Url = token.split('.')[1];
                const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
                const jsonPayload = decodeURIComponent(atob(base64).split('').map(function (c) {
                    return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
                }).join(''));
                return JSON.parse(jsonPayload);
            } catch (error) {
                console.error("Error decoding JWT:", error);
                return {};
            }
        }



        async function fetchUsers() {
            try {
                const usersResponse = await fetch(`/getallusers`, { method: 'GET' });
                if (usersResponse.ok) {
                    const usersData = await usersResponse.json();
                    console.log("Users data:", usersData);
                    allUsers = usersData.users || [];
                    populateAvailableUsers()
                } else {
                    throw new Error(`Failed to fetch users: ${usersResponse.statusText}`);
                }
            } catch (error) {
                console.error("Error fetching users:", error);
                throw error;
            }
        }

        async function fetchTaskBoard() {
            try {
                const taskBoardResponse = await fetch(`/gettaskboardusingid/${boardId}`, { method: 'GET' });
                if (taskBoardResponse.ok) {
                    const data = await taskBoardResponse.json();
                    console.log("Task board data:", data.taskboard.taskboard_data);

                    board = data.taskboard.taskboard_data || {
                        name: "My Task Board",
                        admin: "",
                        collaborators: [],
                        tasks: []
                    };

                } else {
                    throw new Error(`Failed to fetch task board: ${taskBoardResponse.statusText}`);
                }
            } catch (error) {
                console.error("Error fetching task board:", error);
                throw error;
            }
        }

        function updateUI() {
            boardNameEl.textContent = board.name;
            if (userEmailDecoded) {
                const initials = userEmailDecoded.substring(0, 2).toUpperCase();
                userAvatar.textContent = initials;
                userName.textContent = userEmailDecoded.split('@')[0] || "User";
                userEmail.textContent = userEmailDecoded;
            }

            if (userEmailDecoded != board.admin) {
                addTeamMemberSection.classList.add('hidden')
                editBoardNameBtn.classList.add('hidden')
                sidebarShowTeamBtn.classList.add('hidden')
                showTeamModalBtn.classList.add('hidden')
                deleteTaskBoardBtn.classList.add('hidden')

            }

            renderTeamMembers();

            renderTasks();

            updateTaskCounters();
        }

        function showLoadingState() {
            loadingOverlay.classList.remove('hidden');
            appContainer.classList.add('opacity-50', 'pointer-events-none');
        }

        function hideLoadingState() {
            loadingOverlay.classList.add('hidden');
            appContainer.classList.remove('opacity-50', 'pointer-events-none');
        }

        function showErrorState(message, details) {
            loadingOverlay.classList.add('hidden');
            errorModal.classList.remove('hidden');

            errorMessage.textContent = details || "Please try again later";
        }

        function populateAvailableUsers() {
            newTeamMemberSelect.innerHTML = '<option value="">Select a user</option>';

            const availableUsersFiltered = allUsers?.filter(user =>
                !board?.collaborators?.includes(user.email)
            );

            availableUsersFiltered?.forEach(user => {
                const option = document.createElement('option');
                option.value = user.email;
                option.textContent = user.email;
                newTeamMemberSelect.appendChild(option);
            });
        }

        function renderTeamMembers() {
            teamMembersList.innerHTML = '';
            sidebarTeamMembers.innerHTML = '';
            mobileTeamMembers.innerHTML = '';

            if (board.collaborators?.length === 0) {
                teamMembersList.innerHTML = '<p class="text-gray-500 italic">No team members added yet.</p>';
                return;
            }

            board.collaborators?.forEach((memberEmail) => {
                const memberEl = document.createElement('div');
                memberEl.className = 'flex items-center justify-between p-4 bg-gray-50 rounded-lg';

                console.log("email ", memberEmail, board.admin)
                const isAdmin = memberEmail === board.admin;
                const initials = memberEmail.substring(0, 2).toUpperCase();
                console.log("is admin ", isAdmin)
                memberEl.innerHTML = `  
                    <div class="flex items-center">
                        <div class="h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center text-purple-800 font-medium mr-3">
                            ${initials}
                        </div>
                        <div>
                            <p class="font-medium">${memberEmail}</p>
                            ${isAdmin ? '<p class="text-xs text-purple-600">Admin</p>' : ''}
                        </div>
                    </div>
                    ${!isAdmin ? `
                    <button class="text-red-500 hover:text-red-700 delete-team-member" data-email="${memberEmail}">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                    </button>
                    ` : ''}
                `;
                teamMembersList.appendChild(memberEl);

                const sidebarMemberEl = document.createElement('div');
                sidebarMemberEl.className = 'flex items-center text-purple-200';
                sidebarMemberEl.innerHTML = `
                    <div class="h-6 w-6 rounded-full bg-purple-700 flex items-center justify-center text-white text-xs mr-2">
                        ${initials}
                    </div>
                   
                     <div class="flex items-center ">
                            <p class="font-medium truncate">${memberEmail}</p>
                            ${isAdmin ? '<p class="text-[8px] ml-2  text-purple-800 p-1 mt-1 bg-white rounded-xl ">Admin</p>' : ''}
                    </div>
                `;
                sidebarTeamMembers.appendChild(sidebarMemberEl);

                const mobileMemberEl = sidebarMemberEl.cloneNode(true);
                mobileTeamMembers.appendChild(mobileMemberEl);
            });

            document.querySelectorAll('.delete-team-member').forEach(button => {
                button.addEventListener('click', (e) => {
                    const email = e.currentTarget.dataset.email;
                    deleteTeamMember(email);
                });
            });
        }

        async function deleteTeamMember(email) {
            try {
                if (email === board.admin) {
                    alert("Cannot remove the board creator.");
                    return;
                }

                board.tasks?.forEach(task => {
                    if (task.users?.includes(email)) {
                        task.users = task.users?.filter(e => e !== email);
                    }
                });

                board.collaborators = board.collaborators?.filter(e => e !== email);

                const updatedBoardResponse = fetch(`/updateTaskboard/${boardId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(board)
                })

                renderTeamMembers();
                renderTasks();
                updateTaskAssigneeOptions();
                populateAvailableUsers();
            } catch (error) {
                console.error("Error deleting team member:", error);
                alert("Failed to delete team member. Please try again.");
            }
        }

        function updateTaskAssigneeOptions() {
            const currentValue = taskAssigneeSelect.value;

            while (taskAssigneeSelect.options?.length > 1) {
                taskAssigneeSelect.remove(1);
            }

            board.collaborators?.forEach(memberEmail => {
                const option = document.createElement('option');
                option.value = memberEmail;
                option.textContent = memberEmail;
                taskAssigneeSelect.appendChild(option);
            });

            if (currentValue && board.collaborators?.includes(currentValue)) {
                taskAssigneeSelect.value = currentValue;
            }
        }

        function formatDate(dateString) {
            if (!dateString) return '';

            const date = new Date(dateString);

            const hasTime = date.getHours() !== 0 || date.getMinutes() !== 0;

            const options = {
                year: 'numeric',
                month: 'short',
                day: 'numeric'
            };

            if (hasTime) {
                options.hour = '2-digit';
                options.minute = '2-digit';
            }

            return date.toLocaleString('en-US', options);
        }


        function getInitials(email) {
            return email.substring(0, 2).toUpperCase();
        }

        function renderTasks() {
            todoColumn.innerHTML = '';
            inprogressColumn.innerHTML = '';
            completedColumn.innerHTML = '';

            if (board.tasks?.length === 0) {
                const emptyMessage = `
                    <div class="flex flex-col items-center justify-center h-32 text-gray-400">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 mb-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                        </svg>
                        <p>No tasks yet</p>
                    </div>
                `;
                todoColumn.innerHTML = emptyMessage;
                inprogressColumn.innerHTML = emptyMessage;
                completedColumn.innerHTML = emptyMessage;
                return;
            }

            board.tasks?.forEach((task, index) => {
                const isUnassigned = !task.users || task.users?.length === 0;
                const isCompleted = task.status === 'completed';

                let targetColumn;
                if (isCompleted) {
                    targetColumn = completedColumn;
                } else if (task.status === 'inprogress') {
                    targetColumn = inprogressColumn;
                } else {
                    targetColumn = todoColumn;
                }

                const taskCard = document.createElement('div');
                taskCard.className = `task-card mb-3 p-4 bg-white rounded-lg shadow-sm ${(isUnassigned && !isCompleted) ? 'border-l-4 border-red-400' : ''}`;

                let assigneeEmail = '';
                let assigneeInitials = '';
                if (!isUnassigned) {
                    assigneeEmail = task.users[0];
                    assigneeInitials = getInitials(assigneeEmail);
                }
                console.log("finnised ", task.finishedDate)
                const dueDateFormatted = task.pendingDate ? formatDate(task.pendingDate) : 'No due date';
                const completedDateFormatted = task.finishedDate ? formatDate(task.finishedDate) : 'No finished date';
                taskCard.innerHTML = `
                    <div class="flex justify-between items-start mb-3">
                        <h4 class="font-medium text-gray-900 ${isCompleted ? 'line-through text-gray-500' : ''}">${task.name}</h4>
                        <button class="edit-task text-gray-400 hover:text-gray-600" data-index="${index}">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z" />
                            </svg>
                        </button>
                    </div>
                    <div class="flex items-center justify-between text-sm">
                        <div class="flex items-center text-gray-500">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            ${isCompleted ? completedDateFormatted : dueDateFormatted}
                        </div>
                        
                        ${assigneeEmail ? `
                        <div class="h-6 w-6 rounded-full bg-purple-100 flex items-center justify-center text-purple-800 text-xs font-medium" title="${assigneeEmail}">
                            ${assigneeInitials}
                        </div>
                        ` : `
                        ${isCompleted ? ` ` : ` <div class="text-xs px-2 py-1 bg-red-100 text-red-800 rounded-full">
                            Unassigned
                        </div>`}
                        `}
                    </div>
                `;

                targetColumn.appendChild(taskCard);
            });

            document.querySelectorAll('.edit-task')?.forEach(button => {
                button.addEventListener('click', (e) => {
                    const index = parseInt(e.currentTarget.dataset.index);
                    editTask(index);
                });
            });
        }

        function editTask(index) {
            const task = board.tasks[index];
            console.log("edit task ", task)
            if (task) {
                taskModalTitle.textContent = 'Edit Task';
                editTaskIdInput.value = index;
                taskTitleInput.value = task.name;

                if (task.status === 'completed') {
                    taskStatusSelect.value = 'completed';
                    completionDateContainer.classList.remove('hidden');
                } else if (task.status === 'inprogress') {
                    taskStatusSelect.value = 'inprogress';
                    completionDateContainer.classList.add('hidden');
                } else {
                    taskStatusSelect.value = 'todo';
                    completionDateContainer.classList.add('hidden');
                }

                taskDueDateInput.value = task.pendingDate || '';
                taskAssigneeSelect.value = task.users && task.users?.length > 0 ? task.users[0] : '';
                taskCompletionDateInput.value = task.finishedDate || '';

                deleteTaskBtn.classList.remove('hidden');

                updateTaskAssigneeOptions();
                taskModal.classList.remove('hidden');
                taskTitleInput.focus();
            }
        }

        async function deleteTask(index) {
            try {
                if (index >= 0 && index < board.tasks?.length) {
                    board.tasks.splice(index, 1);
                    const updatedBoardResponse = fetch(`/updateTaskboard/${boardId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(board)
                    })
                    renderTasks();
                    updateTaskCounters();
                    taskModal.classList.add('hidden');
                }
            } catch (error) {
                console.error("Error deleting task:", error);
                alert("Failed to delete task. Please try again.");
            }
        }

        function updateTaskCounters() {
            const activeCount = board.tasks?.filter(t => t.status !== 'completed')?.length;
            const completedCount = board.tasks?.filter(t => t.status === 'completed')?.length;
            const totalCount = board.tasks?.length;

            activeCountEl.textContent = activeCount;
            completedCountEl.textContent = completedCount;
            totalCountEl.textContent = totalCount;
        }


        errorCloseBtn.addEventListener('click', () => {
            errorModal.classList.add('hidden');
            init();
        });

        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.remove('hidden');
        });

        closeMobileMenuBtn.addEventListener('click', () => {
            mobileMenu.classList.add('hidden');
        });

        showTeamModalBtn.addEventListener('click', () => {
            teamModal.classList.remove('hidden');
            populateAvailableUsers();
        });

        sidebarShowTeamBtn.addEventListener('click', () => {
            teamModal.classList.remove('hidden');
            populateAvailableUsers();
        });

        mobileShowTeamBtn.addEventListener('click', () => {
            mobileMenu.classList.add('hidden');
            teamModal.classList.remove('hidden');
            populateAvailableUsers();
        });

        closeTeamModalBtn.addEventListener('click', () => {
            teamModal.classList.add('hidden');
        });

        addTeamMemberBtn.addEventListener('click', async () => {
            const email = newTeamMemberSelect.value;
            if (email) {
                try {

                    board.collaborators.push(email);


                    const updatedBoardResponse = fetch(`/updateTaskboard/${boardId}`, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(board)
                    })

                    renderTeamMembers();
                    updateTaskAssigneeOptions();
                    newTeamMemberSelect.value = '';
                    populateAvailableUsers();
                } catch (error) {
                    console.error("Error adding team member:", error);
                    alert("Failed to add team member. Please try again.");
                }
            }
        });

        editBoardNameBtn.addEventListener('click', () => {
            boardNameInput.value = boardNameEl.textContent;
            editNameModal.classList.remove('hidden');
            boardNameInput.focus();
        });

        cancelEditNameBtn.addEventListener('click', () => {
            editNameModal.classList.add('hidden');
        });

        deleteTaskBoardBtn.addEventListener('click', () => {
            if (confirm('Are you sure you want to delete this task board?')) {
                deleteTaskBoard();
            }
        })


        async function deleteTaskBoard() {
            if (board.tasks.length != 0) {
                alert("Please remove all the tasks before deleting")
                return 0
            }
            console.log("board ", board.collaborators)
            if (board.collaborators.length != 1) {
                alert("Please remove all the collaborators before deleting")
                return 0

            }
            const deleteTaskBoardResponse = await fetch(`/deleteTaskBoards`, {
                method: 'DELETE',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ boardId: board.boardId })
            })
            const deleteTaskBoard = await deleteTaskBoardResponse.json()
            window.location.href = "/taskboards"
            console.log("deleted task board ", deleteTaskBoardResponse)
        }

        saveBoardNameBtn.addEventListener('click', async () => {
            const newName = boardNameInput.value.trim();
            if (newName) {
                try {
                    const boardNameExist = await checkBoardName(newName)

                    if (boardNameExist) {
                        alert("Board name already exist")
                    }
                    else {
                        board.name = newName;
                        const updatedBoardResponse = fetch(`/updateTaskboard/${boardId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(board)
                        })
                        boardNameEl.textContent = newName;
                        editNameModal.classList.add('hidden');
                    }

                } catch (error) {
                    console.error("Error updating board name:", error);
                    alert("Failed to update board name. Please try again.");
                }
            }
        });

        taskStatusSelect.addEventListener('change', () => {
            if (taskStatusSelect.value === 'completed') {
                completionDateContainer.classList.remove('hidden');
                if (!taskCompletionDateInput.value) {
                    const now = new Date();
                    const offset = now.getTimezoneOffset();
                    const localTime = new Date(now.getTime() - offset * 60 * 1000);
                    const formattedNow = localTime.toISOString().slice(0, 16);
                    taskCompletionDateInput.value = formattedNow;
                }
            } else {
                completionDateContainer.classList.add('hidden');
            }
        });


        addTaskBtn.addEventListener('click', () => {
            taskModalTitle.textContent = 'Add New Task';
            editTaskIdInput.value = '';
            taskTitleInput.value = '';
            taskStatusSelect.value = 'todo';
            taskDueDateInput.value = '';
            taskAssigneeSelect.value = '';
            taskCompletionDateInput.value = '';
            completionDateContainer.classList.add('hidden');

            // Hide delete button for new tasks
            deleteTaskBtn.classList.add('hidden');

            updateTaskAssigneeOptions();
            taskModal.classList.remove('hidden');
            taskTitleInput.focus();
        });

        closeTaskModalBtn.addEventListener('click', () => {
            taskModal.classList.add('hidden');
        });

        cancelTaskBtn.addEventListener('click', () => {
            taskModal.classList.add('hidden');
        });

        deleteTaskBtn.addEventListener('click', () => {
            const index = parseInt(editTaskIdInput.value);
            if (confirm('Are you sure you want to delete this task?')) {
                deleteTask(index);
            }
        });

        saveTaskBtn.addEventListener('click', async () => {
            const title = taskTitleInput.value.trim();
            const status = taskStatusSelect.value;
            const dueDate = taskDueDateInput.value;
            const assignee = taskAssigneeSelect.value;
            const completionDate = status === 'completed' ? taskCompletionDateInput.value : '';
            const editId = editTaskIdInput.value;

            let isDuplicate = false;

            if (!editId || (editId && board.tasks[editId]?.name !== title)) {
                const checkTitle = await checkTaskTitle(title, boardId);
                if (checkTitle.TaskNameExist) {
                    isDuplicate = true;
                }
            }

            if (isDuplicate) {
                alert("Task name already exists. Please choose a different name.");
                return;
            }

            if (title) {
                try {
                    if (editId) {
                        const taskIndex = parseInt(editId);
                        if (taskIndex >= 0 && taskIndex < board.tasks?.length) {
                            board.tasks[taskIndex].name = title;
                            board.tasks[taskIndex].status = status;
                            board.tasks[taskIndex].pendingDate = dueDate;
                            board.tasks[taskIndex].users = assignee ? [assignee] : [];
                            board.tasks[taskIndex].finishedDate = completionDate;

                            await fetch(`/updateTaskboard/${boardId}`, {
                                method: 'PUT',
                                headers: {
                                    'Content-Type': 'application/json'
                                },
                                body: JSON.stringify(board)
                            });
                        }
                    } else {
                        const newTask = {
                            name: title,
                            status: status,
                            pendingDate: dueDate,
                            users: assignee ? [assignee] : [],
                            finishedDate: completionDate
                        };
                        board.tasks.push(newTask);

                        await fetch(`/updateTaskboard/${boardId}`, {
                            method: 'PUT',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify(board)
                        });
                    }

                    renderTasks();
                    updateTaskCounters();
                    taskModal.classList.add('hidden');
                } catch (error) {
                    console.error("Error saving task:", error);
                    alert("Failed to save task. Please try again.");
                }
            }
        });

        window.addEventListener('click', (e) => {
            if (e.target === editNameModal) {
                editNameModal.classList.add('hidden');
            }
            if (e.target === teamModal) {
                teamModal.classList.add('hidden');
            }
            if (e.target === taskModal) {
                taskModal.classList.add('hidden');
            }
            if (e.target === mobileMenu) {
                mobileMenu.classList.add('hidden');
            }
        });

        init();
    </script>
</body>

</html>